5.656854
5.656854
/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/__init__.py:159: UserWarning: target_y has dtype uint8, which is not a floating point type. This is probably a mistake.
  warnings.warn(
Step: 0 | Average Train Loss: nan | Average Val Loss: nan
Saving checkpoint to
step: 1, loss: nan time: 2222.61ms, mfu: 0.00%
step: 2, loss: nan time: 2122.10ms, mfu: 0.00%
step: 3, loss: nan time: 55.05ms, mfu: 0.00%
step: 4, loss: nan time: 55.25ms, mfu: 0.00%
step: 5, loss: nan time: 50.76ms, mfu: 0.01%
step: 6, loss: nan time: 50.60ms, mfu: 0.01%
step: 7, loss: nan time: 50.52ms, mfu: 0.01%
step: 8, loss: nan time: 50.70ms, mfu: 0.01%
step: 9, loss: nan time: 50.89ms, mfu: 0.01%
step: 10, loss: nan time: 50.57ms, mfu: 0.01%
step: 11, loss: nan time: 55.62ms, mfu: 0.02%
step: 12, loss: nan time: 55.60ms, mfu: 0.02%
step: 13, loss: nan time: 49.96ms, mfu: 0.02%
step: 14, loss: nan time: 50.25ms, mfu: 0.02%
step: 15, loss: nan time: 51.30ms, mfu: 0.02%
step: 16, loss: nan time: 50.67ms, mfu: 0.02%
step: 17, loss: nan time: 52.95ms, mfu: 0.02%
step: 18, loss: nan time: 52.61ms, mfu: 0.02%
step: 19, loss: nan time: 54.82ms, mfu: 0.02%
step: 20, loss: nan time: 55.54ms, mfu: 0.02%
step: 21, loss: nan time: 54.73ms, mfu: 0.02%
step: 22, loss: nan time: 55.72ms, mfu: 0.02%
step: 23, loss: nan time: 53.96ms, mfu: 0.02%
step: 24, loss: nan time: 54.92ms, mfu: 0.02%
step: 25, loss: nan time: 56.07ms, mfu: 0.02%
step: 26, loss: nan time: 52.03ms, mfu: 0.02%
step: 27, loss: nan time: 51.18ms, mfu: 0.02%
step: 28, loss: nan time: 51.40ms, mfu: 0.02%
step: 29, loss: nan time: 61.16ms, mfu: 0.02%
step: 30, loss: nan time: 50.77ms, mfu: 0.02%
step: 31, loss: nan time: 51.96ms, mfu: 0.02%
step: 32, loss: nan time: 51.15ms, mfu: 0.02%
step: 33, loss: nan time: 50.52ms, mfu: 0.02%
step: 34, loss: nan time: 51.48ms, mfu: 0.02%
step: 35, loss: nan time: 50.50ms, mfu: 0.02%
step: 36, loss: nan time: 51.55ms, mfu: 0.02%
step: 37, loss: nan time: 49.54ms, mfu: 0.02%
step: 38, loss: nan time: 50.68ms, mfu: 0.02%
step: 39, loss: nan time: 50.05ms, mfu: 0.02%
step: 40, loss: nan time: 51.09ms, mfu: 0.02%
step: 41, loss: nan time: 51.58ms, mfu: 0.02%
step: 42, loss: nan time: 53.47ms, mfu: 0.02%
step: 43, loss: nan time: 51.55ms, mfu: 0.02%
step: 44, loss: nan time: 53.44ms, mfu: 0.02%
step: 45, loss: nan time: 52.63ms, mfu: 0.02%
step: 46, loss: nan time: 53.57ms, mfu: 0.02%
step: 47, loss: nan time: 51.64ms, mfu: 0.02%
step: 48, loss: nan time: 52.39ms, mfu: 0.02%
step: 49, loss: nan time: 51.04ms, mfu: 0.02%
step: 50, loss: nan time: 52.94ms, mfu: 0.02%
step: 51, loss: nan time: 50.23ms, mfu: 0.02%
step: 52, loss: nan time: 51.26ms, mfu: 0.02%
step: 53, loss: nan time: 52.22ms, mfu: 0.02%
step: 54, loss: nan time: 54.37ms, mfu: 0.02%
step: 55, loss: nan time: 50.67ms, mfu: 0.02%
step: 56, loss: nan time: 53.44ms, mfu: 0.02%
step: 57, loss: nan time: 51.46ms, mfu: 0.02%
step: 58, loss: nan time: 53.66ms, mfu: 0.02%
step: 59, loss: nan time: 53.94ms, mfu: 0.02%
step: 60, loss: nan time: 51.92ms, mfu: 0.02%
step: 61, loss: nan time: 50.97ms, mfu: 0.02%
step: 62, loss: nan time: 50.52ms, mfu: 0.02%
step: 63, loss: nan time: 131.36ms, mfu: 0.02%
step: 64, loss: nan time: 55.75ms, mfu: 0.02%
step: 65, loss: nan time: 58.92ms, mfu: 0.02%
step: 66, loss: nan time: 54.34ms, mfu: 0.02%
Traceback (most recent call last):
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 394, in <module>
    main()
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/draccus/argparsing.py", line 182, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 391, in main
    trainer.train()
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 356, in train
    self.state, loss = self.train_step(self.train_key)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 305, in train_step
    key, opt_state, model, loss = self._train_step(key)
                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 206, in __call__
    return self._call(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_module.py", line 875, in __call__
    return self.__func__(self.__self__, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 200, in _call
    out = self._cached(dynamic_donate, dynamic_nodonate, static)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/core.py", line 129, in tree_unflatten
    @classmethod
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 394, in <module>
    main()
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/draccus/argparsing.py", line 182, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 391, in main
    trainer.train()
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 356, in train
    self.state, loss = self.train_step(self.train_key)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 305, in train_step
    key, opt_state, model, loss = self._train_step(key)
                                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 206, in __call__
    return self._call(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_module.py", line 875, in __call__
    return self.__func__(self.__self__, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 200, in _call
    out = self._cached(dynamic_donate, dynamic_nodonate, static)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/core.py", line 129, in tree_unflatten
    @classmethod
KeyboardInterrupt
step: 67, loss: nan time: 54.19ms, mfu: 0.02%
step: 68, loss: nan time: 57.89ms, mfu: 0.02%
step: 69, loss: nan time: 54.44ms, mfu: 0.02%
step: 70, loss: nan time: 54.10ms, mfu: 0.02%
step: 71, loss: nan time: 54.57ms, mfu: 0.02%
step: 72, loss: nan time: 51.51ms, mfu: 0.02%
step: 73, loss: nan time: 52.01ms, mfu: 0.02%
step: 74, loss: nan time: 52.87ms, mfu: 0.02%
step: 75, loss: nan time: 52.28ms, mfu: 0.02%
step: 76, loss: nan time: 52.01ms, mfu: 0.02%
step: 77, loss: nan time: 52.22ms, mfu: 0.02%
step: 78, loss: nan time: 52.98ms, mfu: 0.02%
step: 79, loss: nan time: 53.39ms, mfu: 0.02%
step: 80, loss: nan time: 51.70ms, mfu: 0.02%
step: 81, loss: nan time: 52.53ms, mfu: 0.02%