Traceback (most recent call last):
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 394, in <module>
    main()
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/draccus/argparsing.py", line 182, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 391, in main
    trainer.train()
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 322, in train
    _, train_loss       = self.estimate_loss('train', self.eval_key)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 288, in estimate_loss
    key, losses = hax.fold(_step, self.EvalSteps)((key, 0.0), hax.zeros(self.EvalSteps))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 250, in scan
    init_flat, carry_avals, carry_avals_out, init_tree, *rest = _create_jaxpr(init)
                                                                ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 236, in _create_jaxpr
    jaxpr, consts, out_tree = _initial_style_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 64, in _initial_style_jaxpr
    jaxpr, consts, out_tree = _initial_style_open_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 58, in _initial_style_open_jaxpr
    jaxpr, _, consts = pe.trace_to_jaxpr_dynamic(wrapped_fun, in_avals, debug)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 285, in _step
    curr_loss            = self.compute_batch_loss(model, X, y, run_key)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 206, in __call__
    return self._call(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_module.py", line 875, in __call__
    return self.__func__(self.__self__, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 200, in _call
    out = self._cached(dynamic_donate, dynamic_nodonate, static)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
                                                 ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
                                                 ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/api.py", line 306, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 505, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
                                                      ^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 971, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
                                    ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 345, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 924, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 49, in fun_wrapped
    out = fun(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 226, in loss_fn
    preds = model(X, key=key)
            ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 307, in __call__
    x = self.blocks.fold(
        ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_module.py", line 875, in __call__
    return self.__func__(self.__self__, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 103, in fold
    return haliax.fold(do_block, self.Block)(init, self.stacked, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 250, in scan
    init_flat, carry_avals, carry_avals_out, init_tree, *rest = _create_jaxpr(init)
                                                                ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 236, in _create_jaxpr
    jaxpr, consts, out_tree = _initial_style_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 64, in _initial_style_jaxpr
    jaxpr, consts, out_tree = _initial_style_open_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 58, in _initial_style_open_jaxpr
    jaxpr, _, consts = pe.trace_to_jaxpr_dynamic(wrapped_fun, in_avals, debug)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 107, in _do_block
    return block(carry, *extra_args, **extra_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 242, in __call__
    attn_x = self.attn(x, padding_mask, key=k1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 112, in __call__
    scores /= self._scale_f
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/core.py", line 558, in __truediv__
    return haliax.true_divide(self, other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/wrap.py", line 106, in binop
    return op(a, b)
           ^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/__init__.py", line 819, in true_divide
    return jnp.true_divide(x1, x2)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
                                                 ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
                                                 ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/api.py", line 306, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 505, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
                                                      ^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 971, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
                                    ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 345, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 924, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/ufuncs.py", line 255, in true_divide
    x1, x2 = promote_args_inexact("true_divide", x1, x2)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 370, in promote_args_inexact
    check_arraylike(fun_name, *args)
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 328, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
jax._src.traceback_util.UnfilteredStackTrace: TypeError: true_divide requires ndarray or scalar arguments, got <class 'haliax.core.NamedArray'> at position 0.
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 394, in <module>
    main()
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/draccus/argparsing.py", line 182, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 391, in main
    trainer.train()
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 322, in train
    _, train_loss       = self.estimate_loss('train', self.eval_key)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 288, in estimate_loss
    key, losses = hax.fold(_step, self.EvalSteps)((key, 0.0), hax.zeros(self.EvalSteps))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 285, in _step
    curr_loss            = self.compute_batch_loss(model, X, y, run_key)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 226, in loss_fn
    preds = model(X, key=key)
            ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 307, in __call__
    x = self.blocks.fold(
        ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 103, in fold
    return haliax.fold(do_block, self.Block)(init, self.stacked, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 107, in _do_block
    return block(carry, *extra_args, **extra_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 242, in __call__
    attn_x = self.attn(x, padding_mask, key=k1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 112, in __call__
    scores /= self._scale_f
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/core.py", line 558, in __truediv__
    return haliax.true_divide(self, other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/wrap.py", line 106, in binop
    return op(a, b)
           ^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/__init__.py", line 819, in true_divide
    return jnp.true_divide(x1, x2)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/ufuncs.py", line 255, in true_divide
    x1, x2 = promote_args_inexact("true_divide", x1, x2)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 370, in promote_args_inexact
    check_arraylike(fun_name, *args)
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 328, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
TypeError: true_divide requires ndarray or scalar arguments, got <class 'haliax.core.NamedArray'> at position 0.
Traceback (most recent call last):
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 394, in <module>
    main()
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/draccus/argparsing.py", line 182, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 391, in main
    trainer.train()
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 322, in train
    _, train_loss       = self.estimate_loss('train', self.eval_key)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 288, in estimate_loss
    key, losses = hax.fold(_step, self.EvalSteps)((key, 0.0), hax.zeros(self.EvalSteps))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 250, in scan
    init_flat, carry_avals, carry_avals_out, init_tree, *rest = _create_jaxpr(init)
                                                                ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 236, in _create_jaxpr
    jaxpr, consts, out_tree = _initial_style_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 64, in _initial_style_jaxpr
    jaxpr, consts, out_tree = _initial_style_open_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 58, in _initial_style_open_jaxpr
    jaxpr, _, consts = pe.trace_to_jaxpr_dynamic(wrapped_fun, in_avals, debug)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 285, in _step
    curr_loss            = self.compute_batch_loss(model, X, y, run_key)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 206, in __call__
    return self._call(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_module.py", line 875, in __call__
    return self.__func__(self.__self__, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 200, in _call
    out = self._cached(dynamic_donate, dynamic_nodonate, static)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
                                                 ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
                                                 ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/api.py", line 306, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 505, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
                                                      ^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 971, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
                                    ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 345, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 924, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_jit.py", line 49, in fun_wrapped
    out = fun(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 226, in loss_fn
    preds = model(X, key=key)
            ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 307, in __call__
    x = self.blocks.fold(
        ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/equinox/_module.py", line 875, in __call__
    return self.__func__(self.__self__, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 103, in fold
    return haliax.fold(do_block, self.Block)(init, self.stacked, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 250, in scan
    init_flat, carry_avals, carry_avals_out, init_tree, *rest = _create_jaxpr(init)
                                                                ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/loops.py", line 236, in _create_jaxpr
    jaxpr, consts, out_tree = _initial_style_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 64, in _initial_style_jaxpr
    jaxpr, consts, out_tree = _initial_style_open_jaxpr(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/lax/control_flow/common.py", line 58, in _initial_style_open_jaxpr
    jaxpr, _, consts = pe.trace_to_jaxpr_dynamic(wrapped_fun, in_avals, debug)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 107, in _do_block
    return block(carry, *extra_args, **extra_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 242, in __call__
    attn_x = self.attn(x, padding_mask, key=k1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 112, in __call__
    scores /= self._scale_f
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/core.py", line 558, in __truediv__
    return haliax.true_divide(self, other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/wrap.py", line 106, in binop
    return op(a, b)
           ^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/__init__.py", line 819, in true_divide
    return jnp.true_divide(x1, x2)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
                                                 ^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
                                                 ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/api.py", line 306, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 505, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
                                                      ^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 971, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
                                    ^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 345, in memoized_fun
    ans = call(fun, *args)
          ^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/pjit.py", line 924, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/ufuncs.py", line 255, in true_divide
    x1, x2 = promote_args_inexact("true_divide", x1, x2)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 370, in promote_args_inexact
    check_arraylike(fun_name, *args)
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 328, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
jax._src.traceback_util.UnfilteredStackTrace: TypeError: true_divide requires ndarray or scalar arguments, got <class 'haliax.core.NamedArray'> at position 0.
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 394, in <module>
    main()
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/draccus/argparsing.py", line 182, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 391, in main
    trainer.train()
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 322, in train
    _, train_loss       = self.estimate_loss('train', self.eval_key)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 288, in estimate_loss
    key, losses = hax.fold(_step, self.EvalSteps)((key, 0.0), hax.zeros(self.EvalSteps))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 285, in _step
    curr_loss            = self.compute_batch_loss(model, X, y, run_key)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/train.py", line 226, in loss_fn
    preds = model(X, key=key)
            ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 307, in __call__
    x = self.blocks.fold(
        ^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 103, in fold
    return haliax.fold(do_block, self.Block)(init, self.stacked, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 129, in scanned_f
    return scan_preconfig(init, *args, **kwargs)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 88, in scanned_f
    carry, ys = lax.scan(wrapped_fn, init, leaves, reverse=reverse, unroll=unroll)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 83, in wrapped_fn
    carry, y = f(carry, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/hof.py", line 124, in scan_compatible_fn
    return fn(carry, *args, **kwargs), None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/nn/scan.py", line 107, in _do_block
    return block(carry, *extra_args, **extra_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 242, in __call__
    attn_x = self.attn(x, padding_mask, key=k1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/Desktop/ML Projects/GPT_nano/model.py", line 112, in __call__
    scores /= self._scale_f
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/core.py", line 558, in __truediv__
    return haliax.true_divide(self, other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/wrap.py", line 106, in binop
    return op(a, b)
           ^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/haliax/__init__.py", line 819, in true_divide
    return jnp.true_divide(x1, x2)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/ufuncs.py", line 255, in true_divide
    x1, x2 = promote_args_inexact("true_divide", x1, x2)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 370, in promote_args_inexact
    check_arraylike(fun_name, *args)
  File "/Users/rohanmehta/anaconda3/envs/jax/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 328, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
TypeError: true_divide requires ndarray or scalar arguments, got <class 'haliax.core.NamedArray'> at position 0.